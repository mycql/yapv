<head>
  <script src="../dist/index.js"></script>
</head>
<body>
  <canvas id="canvas" width="600" height="600"></canvas>
  <script>
    window.addEventListener('load', function() {
      var model = {
        sequenceConfig: {
          range: {
            start: 1,
            end: 201
          }
        },
        labels: [
          {
            text: 'PSB0011',
            displayConfig: {
              type: 'text',
              style: 'text-align: center; font: 40px "Arial", sans-serif; fill: blue;'
            }
          },
          {
            text: 'CDS',
            displayConfig: {
              type: 'text',
              style: 'text-align: center; font: 20px "Courier", monotype; fill: orange;',
              vOffset: 30,
              hOffset: 60
            }
          }
        ],
        tracks: [
          {
            displayConfig: {
              distance: 200,
              width: 10,
              style: 'stroke: blue; fill: white;'
            },
            axes: [
              {
                displayConfig: {
                  distance: -15,
                  width: 2,
                  style: 'stroke: orange; fill: brown;',
                  scales: [
                    {
                      width: 4,
                      distance: -4,
                      total: 10,
                      style: 'stroke: green; stroke-width: 2;',
                      label: {
                        type: 'text',
                        style: 'text-align: center; font: 10px "Courier", monotype; fill: teal;',
                        distance: -15
                      }
                    }
                  ]
                }
              }
            ],
            markers: [
              {
                displayConfig: {
                  width: 14,
                  style: 'stroke: red; fill: yellow; stroke-opacity: 0.4; stroke-width: 5; stroke-dasharray: 5,10,5; stroke-linejoin: round;'
                },
                location: {
                  start: 1,
                  end: 101
                },
                direction: '+',
                labels: [
                  {
                    text: 'CRISPR 001',
                    displayConfig: {
                      type: 'path',
                      style: 'text-align: left; font: 10px "Courier New", monospace; fill: red; stroke: blue; letter-spacing: 5px;'
                    }
                  },
                  {
                    text: 'gene',
                    displayConfig: {
                      type: 'path',
                      style: 'text-align: left; font: 10px "Courier New", monospace; fill: gray;',
                      vOffset: -5,
                      hOffset: 20
                    }
                  }
                ]
              },
              {
                displayConfig: {
                  width: 10,
                  style: 'stroke: green; fill: purple; fill-opacity: 0.2;',
                  anchor: {
                    width: 18,
                    height: 30
                  }
                },
                location: {
                  start: 121,
                  end: 171
                },
                direction: '*',
                labels: [
                  {
                    text: 'CRISPR 002',
                    displayConfig: {
                      type: 'text',
                      style: 'text-align: center; font: 10px "Arial", sans-serif; fill: red;'
                    }
                  }
                ]
              }
            ]
          },
          {
            displayConfig: {
              distance: 235,
              width: 10
            },
            axes: [
              {
                displayConfig: {
                  distance: -15,
                  width: 2,
                  style: 'stroke: red; fill: violet;',
                  scales: [
                    {
                      width: 4,
                      distance: -4,
                      interval: 10,
                      style: 'stroke: green; stroke-width: 2;',
                      label: {
                        type: 'path',
                        style: 'text-align: center; font: 10px "Arial", sans-serif; fill: red;',
                        distance: 10
                      }
                    }
                  ]
                }
              }
            ],
            markers: []
          },
          {
            displayConfig: {
              distance: 260,
              width: 10
            },
            axes: [
              {
                displayConfig: {
                  distance: 14,
                  width: 2,
                  style: 'stroke: green; fill: yellow;',
                  scales: [
                    {
                      width: 10,
                      distance: 4,
                      ticks: [50, 100, 150, 200],
                      style: 'stroke: red; stroke-width: 4;',
                      label: {
                        type: 'text',
                        style: 'text-align: center; font: 10px "Arial", sans-serif; fill: red;',
                        distance: -10
                      }
                    }
                  ]
                }
              }
            ],
            markers: [
              {
                displayConfig: {
                  width: 14,
                  style: 'stroke: red; fill: limegreen; fill-opacity: 0.2; stroke-width: 1; stroke-linejoin: round;',
                  anchor: {
                    width: 18,
                    height: 30
                  }
                },
                location: {
                  start: 180,
                  end: 20
                },
                direction: '+',
                labels: [
                  {
                    text: 'CRISPR 003',
                    displayConfig: {
                      type: 'path',
                      style: 'text-align: left; font: 10px "Courier New", monospace; fill: red; stroke: blue; letter-spacing: 5px;'
                    }
                  }
                ]
              },
              {
                displayConfig: {
                  width: 14,
                  style: 'stroke: blue; fill: orange; fill-opacity: 0.2; stroke-width: 1;',
                  anchor: {
                    width: 18,
                    height: 30
                  }
                },
                location: {
                  start: 80,
                  end: 120
                },
                direction: '-',
                labels: [
                  {
                    text: 'CRISPR 004',
                    displayConfig: {
                      type: 'text',
                      style: 'text-align: center; font: 10px "Courier New", monospace; fill: green; stroke: green; letter-spacing: 5px;'
                    }
                  }
                ]
              }
            ]
          }
        ]
      };
      var mapComponent = new CanvasPlasmid.Circular.VectorMapComponent();
      var canvas = document.querySelector('#canvas');
      var presets = ['purple', 'red', 'green', 'orange', 'violet', 'blue', 'brown', 'yellow', 'maroon', 'pink'];
      var location = model.tracks[0].markers[0].location;
      var origStart = location.start;
      var direction = '+';
      function animate() {
        var colorIdx = Math.floor(Math.random() * 10);
        let style = 'text-align: center; font: 40px "Arial", sans-serif;';
        style = style + ' fill: ' + presets[colorIdx] + ';';
        model.labels[0].displayConfig.style = style;
        if(location.start >= location.end) {
          direction = '-';
        }
        if(location.start <= origStart) {
          direction = '+';
        }
        if (direction === '+') {
          location.start += 1;
        } else {
          location.start -= 1;
        }
        mapComponent.draw(canvas, model).then(() => {
          // setTimeout(animate, 60 / 1000);
        });
      }
      animate();
    });
  </script>
</body>